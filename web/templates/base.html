{{define "base"}}
<!DOCTYPE html>
<html lang="{{if .config}}{{.config.SiteLang}}{{else}}en{{end}}" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" content="{{if .title}}{{.title}}{{else if .site}}{{.site.Name}}{{else}}GopherWiki{{end}}" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="{{if .config}}{{.config.SiteDescription}}{{else}}A minimalistic wiki powered by Go, markdown and git.{{end}}" />
  <link rel="icon" href="/static/img/otter-favicon2.png">
  <title>{{if .title}}{{.title}} - {{end}}{{if .site}}{{.site.Name}}{{else}}GopherWiki{{end}}</title>
  <link href="/static/css/pico.classless.min.css" rel="stylesheet" media="screen" />
  <link href="{{debugUnixtime "/static/css/gopherwiki.css"}}" rel="stylesheet" media="screen" />
  <link href="/static/css/print.css" rel="stylesheet" media="print" />
  <link rel="stylesheet" href="/static/css/fontawesome-all.min.css">
  <link href="/static/css/pygments.css" rel="stylesheet" media="screen"/>
  <link href="/static/css/roboto.css" rel="stylesheet"/>
  <script src="{{debugUnixtime "/static/js/gopherwiki-ui.js"}}"></script>
  {{if .templateType}}{{if eq .templateType "page"}}{{template "page_head" .}}{{end}}{{end}}
  {{if .templateType}}{{if eq .templateType "editor"}}{{template "editor_head" .}}{{end}}{{end}}
</head>
<body>
{{if .templateType}}{{if eq .templateType "editor"}}{{template "editor_bodytop" .}}{{end}}{{end}}

    <!-- Navbar -->
    <nav class="wiki-navbar">
        <button id="toggle-sidebar-btn" class="btn btn-action" type="button" onclick="toggleSidebar()" title="Toggle Sidebar">
            <i class="fas fa-bars"></i>
        </button>
        <a href="/" class="navbar-brand">
            <img src="{{if and .site .site.Logo}}{{.site.Logo}}{{else}}/static/img/otterhead.png{{end}}" alt="" id="site_logo"/>
            <span class="d-none d-sm-flex text-truncate">{{if .site}}{{.site.Name}}{{else}}GopherWiki{{end}}</span>
        </a>
        {{if .templateType}}{{if eq .templateType "editor"}}{{template "editor_navbar_editor" .}}{{end}}{{end}}
        <div class="navbar-actions">
            {{if not (and .templateType (eq .templateType "editor"))}}
            <form action="/-/search" method="get" class="relative">
            <span class="top-search">
            <input id="search-query" name="q" type="text" placeholder="Search" style="padding-right: 2.5rem;">
            </span>
            </form>
            {{end}}
            <details class="dropdown">
                <summary class="btn btn-action" title="Menu">
                    <i class="fas fa-ellipsis-v"></i>
                </summary>
                <ul>
                    {{if .templateType}}
                      {{if eq .templateType "page"}}{{template "page_navbardropdown" .}}{{end}}
                    {{end}}
                    {{if not (and .templateType (eq .templateType "page"))}}
                    <li><a href="#" onclick="toggleDarkMode(); return false;">
                        <span class="dropdown-icon"><i class="far fa-moon"></i></span>
                        Toggle dark mode
                    </a></li>
                    {{if .current_user}}{{if .current_user.is_authenticated}}
                    <li><a href="/-/settings">
                        <span class="dropdown-icon"><i class="fas fa-user-cog"></i></span>
                        Settings
                    </a></li>
                    <li><a href="/-/logout">
                        <span class="dropdown-icon"><i class="fas fa-sign-out-alt"></i></span>
                        Logout
                    </a></li>
                    {{else}}
                    <li><a href="/-/login">
                        <span class="dropdown-icon"><i class="fas fa-sign-in-alt"></i></span>
                        Login
                    </a></li>
                    {{end}}{{else}}
                    <li><a href="/-/login">
                        <span class="dropdown-icon"><i class="fas fa-sign-in-alt"></i></span>
                        Login
                    </a></li>
                    {{end}}
                    {{end}}
                </ul>
            </details>
            {{if .templateType}}
              {{if eq .templateType "page"}}{{template "page_navbar" .}}{{end}}
              {{if eq .templateType "editor"}}{{template "editor_navbar" .}}{{end}}
            {{end}}
        </div>
    </nav>

    <div class="wiki-layout">
        <!-- Sidebar -->
        <aside class="wiki-sidebar">
            <div class="sidebar-menu w-full flex-grow-1">
                <a href="/" class="sidebar-link">
                    <span class="sidebar-icon"><i class="fas fa-home"></i></span>
                    Home
                </a>
                <a href="/-/pageindex" class="sidebar-link">
                    <span class="sidebar-icon"><i class="fas fa-list"></i></span>
                    A - Z
                </a>
                <a href="/-/changelog" class="sidebar-link">
                    <span class="sidebar-icon"><i class="fas fa-history"></i></span>
                    Changelog
                </a>
                <a href="/-/issues" class="sidebar-link">
                    <span class="sidebar-icon"><i class="fas fa-tasks"></i></span>
                    Issues
                </a>
                <a href="/-/create" id="create-page-btn" class="sidebar-link">
                    <span class="sidebar-icon"><i class="far fa-file"></i></span>
                    Create page
                </a>
                {{if .current_user}}{{if .current_user.is_admin}}
                <a href="/-/admin" class="sidebar-link">
                    <span class="sidebar-icon"><i class="fas fa-cog"></i></span>
                    Admin
                </a>
                {{end}}{{end}}
                {{if .sidebar_tree}}
                <div class="sidebar-divider"></div>
                <div class="sidebar-tree" style="padding: 0.25rem 0.5rem;">
                    {{renderPageTree .sidebar_tree}}
                </div>
                {{end}}
                <br />
            </div>
        </aside>
        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- Content -->
        <main class="wiki-main" id="content-wrapper">
            <div class="container">
                <div class="content">
                    {{if .templateType}}
                      {{if eq .templateType "page"}}{{template "page_breadcrumbs" .}}{{template "page_content" .}}{{end}}
                      {{if eq .templateType "editor"}}{{template "editor_content" .}}{{end}}
                      {{if eq .templateType "generic"}}{{template "generic_content" .}}{{end}}
                    {{else}}
                      {{if .htmlcontent}}{{.htmlcontent}}{{else}}<p>Content goes here</p>{{end}}
                    {{end}}
                </div>
                {{if .templateType}}
                  {{if eq .templateType "page"}}{{template "page_extra_nav" .}}{{end}}
                  {{if eq .templateType "editor"}}{{template "editor_extra_nav" .}}{{end}}
                {{end}}
            </div>
        </main>
    </div>

  <script src="/static/js/htmx.2.0.6.min.js"></script>
  <script src="{{debugUnixtime "/static/js/gopherwiki.js"}}" type="text/javascript" charset="utf-8"></script>
  {{if .templateType}}
    {{if eq .templateType "page"}}{{template "page_js" .}}{{end}}
    {{if eq .templateType "editor"}}{{template "editor_js" .}}{{end}}
  {{end}}
</body>
</html>
{{end}}
