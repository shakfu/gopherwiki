{{define "generic_content"}}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
        <li class="breadcrumb-item"><a href="/-/issues">Issues</a></li>
        {{if .isEdit}}
        <li class="breadcrumb-item"><a href="/-/issues/{{.issue.ID}}">#{{.issue.ID}}</a></li>
        <li class="breadcrumb-item active">Edit</li>
        {{else}}
        <li class="breadcrumb-item active">New Issue</li>
        {{end}}
    </ol>
</nav>

<h1>{{if .isEdit}}Edit Issue #{{.issue.ID}}{{else}}New Issue{{end}}</h1>

<form action="{{if .isEdit}}/-/issues/{{.issue.ID}}/edit{{else}}/-/issues/new{{end}}" method="post">
    <div class="form-group">
        <label for="title">Title</label>
        <input type="text" name="title" id="title" class="form-control"
               value="{{if .isEdit}}{{.issue.Title}}{{end}}"
               placeholder="Enter a descriptive title" required>
    </div>

    <div class="form-group">
        <label for="description">Description</label>
        <textarea name="description" id="description" class="form-control" rows="10"
                  placeholder="Describe the issue. You can use Markdown and [[wikilinks]].">{{if .isEdit}}{{.issue.Description.String}}{{end}}</textarea>
        <small class="form-text text-muted">
            Supports Markdown formatting and [[wikilinks]] to link to wiki pages.
        </small>
    </div>

    {{if .availableCategories}}
    <div class="form-group">
        <label for="category">Category</label>
        <select name="category" id="category" class="form-control" required>
            <option value="">-- Select a category --</option>
            {{$currentCategory := ""}}
            {{if $.isEdit}}{{if $.issue.Category.Valid}}{{$currentCategory = $.issue.Category.String}}{{end}}{{end}}
            {{range .availableCategories}}
            <option value="{{.}}" {{if eq . $currentCategory}}selected{{end}}>{{.}}</option>
            {{end}}
        </select>
        <small class="form-text text-muted">
            Select a category for this issue.
        </small>
    </div>
    {{end}}

    <div class="form-group">
        <label>Tags</label>
        <div class="mt-1">
            {{range .availableTags}}
            <div class="form-check form-check-inline mr-3">
                <input class="form-check-input" type="checkbox" name="tags" id="tag-{{.}}" value="{{.}}"
                       {{if $.isEdit}}{{range $.tags}}{{if eq . $}}checked{{end}}{{end}}{{end}}>
                <label class="form-check-label" for="tag-{{.}}">{{.}}</label>
            </div>
            {{end}}
        </div>
        <small class="form-text text-muted">Select one or more tags to categorize this issue.</small>
    </div>

    <div class="form-group">
        <button type="submit" class="btn btn-primary">{{if .isEdit}}Update Issue{{else}}Create Issue{{end}}</button>
        <a href="{{if .isEdit}}/-/issues/{{.issue.ID}}{{else}}/-/issues{{end}}" class="btn btn-outline-secondary">Cancel</a>
    </div>
</form>
{{end}}
